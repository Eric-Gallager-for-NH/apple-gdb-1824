///////////static OSErr InitpseudoCarbon (void);OSErr pseudoCarbonInitializeFragment (struct CFragInitBlock* initBlkPtr);void pseudoCarbonTerminateFragment (void);///////////#if !TARGET_API_MAC_CARBONQDGlobals qd;			/*	define the Quickdraw globals here!	*/#endif///////////#define DEFINE_INTERFACELIB_PROC(_type, _name, _argtyps, _args) \static pascal _type (*the##_name)_argtyps; \pascal _type _name _argtyps{the##_name _args;}#define DEFINE_INTERFACELIB_FUNC(_type, _name, _argtyps, _args) \static pascal _type (*the##_name)_argtyps; \pascal _type _name _argtyps{return(the##_name _args);}#define DEFINE_INTERFACELIB_PROC_C(_type, _name, _argtyps, _args) \static _type (*the##_name)_argtyps; \_type _name _argtyps{the##_name _args;}#define DEFINE_INTERFACELIB_FUNC_C(_type, _name, _argtyps, _args) \static _type (*the##_name)_argtyps; \ _type _name _argtyps{return(the##_name _args);}#define LOAD_INTERFACELIB_PROC(_name,_namepstr) \if (err == noErr) {err=FindSymbol(myInterfaceLibconnID, _namepstr, &(Ptr)the##_name, NULL);}///////////// regexps to convert from univ hdrs// EXTERN_API\((.*)\)\r(.*)\( \r([^)]*)\).*// DEFINE_INTERFACELIB_FUNC( \1, \2,\r(\3),\r(\3))// DEFINE_INTERFACELIB_FUNC(\( *void *,)// DEFINE_INTERFACELIB_PROC\1// ^(\(?  )[^ ]+ ?\*?(     *[^)]*\)\))// \1\2// DEFINE_INTERFACELIB_[^(]*\([^,]*, *([^,]*),[^D]*\)\)// LOAD_INTERFACELIB_PROC(\1,"\\p\1")///////////DEFINE_INTERFACELIB_FUNC( Handle, LMGetSysMapHndl,(void),())DEFINE_INTERFACELIB_FUNC( Handle, LMGetTopMapHndl,(void),())DEFINE_INTERFACELIB_PROC(  void, IUDateString,(long dateTime, DateForm longFlag, Str255 result),( dateTime,  longFlag,  result))DEFINE_INTERFACELIB_PROC(  void, IUTimeString,(long dateTime, Boolean wantSeconds, Str255 result),( dateTime,  wantSeconds,  result))DEFINE_INTERFACELIB_FUNC(  UniversalProcPtr , GetToolboxTrapAddress,(  UInt16                  trapNum),(                    trapNum))DEFINE_INTERFACELIB_FUNC( QHdrPtr , GetEvQHdr,( void ),(  ))DEFINE_INTERFACELIB_FUNC(  Boolean , OSEventAvail,(  EventMask               mask,  EventRecord *           theEvent),(                mask,             theEvent))DEFINE_INTERFACELIB_FUNC(  OSErr , PBControlAsync,(  ParmBlkPtr              paramBlock),(               paramBlock))DEFINE_INTERFACELIB_FUNC(  OSErr , GetWDInfo,(  short                   wdRefNum,  short *                 vRefNum,  long *                  dirID,  long *                  procID),(                    wdRefNum,                   vRefNum,                    dirID,                    procID))DEFINE_INTERFACELIB_FUNC(  OSErr , SysEnvirons,(  short                   versionRequested,  SysEnvRec *             theWorld),(                    versionRequested,               theWorld))DEFINE_INTERFACELIB_FUNC(  UniversalProcPtr , NGetTrapAddress,(  UInt16                  trapNum,  TrapType                tTyp),(                   trapNum,                 tTyp))DEFINE_INTERFACELIB_FUNC(  OSErr , PBControlSync,(  ParmBlkPtr              paramBlock),(               paramBlock))DEFINE_INTERFACELIB_FUNC(  OSErr , PBOpenSync,(  ParmBlkPtr              paramBlock),(               paramBlock))DEFINE_INTERFACELIB_FUNC_C(  UniversalProcPtr , NewRoutineDescriptor,(  ProcPtr                 theProc,  ProcInfoType            theProcInfo,  ISAType                 theISA),(                  theProc,             theProcInfo,                  theISA))DEFINE_INTERFACELIB_PROC_C(  void , DisposeRoutineDescriptor,(  UniversalProcPtr        theProcPtr),(         theProcPtr))DEFINE_INTERFACELIB_FUNC_C( long , CallUniversalProc,(  UniversalProcPtr        theProcPtr,  ProcInfoType            procInfo,   ...),(         theProcPtr,             procInfo   ))DEFINE_INTERFACELIB_PROC(  void , CloseWindow,(  WindowRef               window),(                window))DEFINE_INTERFACELIB_FUNC(  Ptr , NewPtrSys,(  Size                    byteCount),(                     byteCount))DEFINE_INTERFACELIB_FUNC(  Handle , NewHandleSys,(  Size                    byteCount),(                     byteCount))DEFINE_INTERFACELIB_FUNC_C(  StringPtr , c2pstr,(  char *                  aStr),(                    aStr))DEFINE_INTERFACELIB_FUNC_C(  char *, p2cstr,(  StringPtr               aStr),(                aStr))DEFINE_INTERFACELIB_PROC( void , MaxApplZone,(void),())//////////static OSErr InitpseudoCarbon(void){	CFragConnectionID myInterfaceLibconnID;	Ptr		mymainAddr;	Str255	myerrMessage;	OSErr err = noErr;	err=GetSharedLibrary("\pInterfaceLib", kPowerPCCFragArch, kFindCFrag,&myInterfaceLibconnID,		&mymainAddr, myerrMessage);	if (err == noErr) {	LOAD_INTERFACELIB_PROC(LMGetSysMapHndl,"\pLMGetSysMapHndl")LOAD_INTERFACELIB_PROC(LMGetTopMapHndl,"\pLMGetTopMapHndl")LOAD_INTERFACELIB_PROC(IUDateString,"\pIUDateString")LOAD_INTERFACELIB_PROC(IUTimeString,"\pIUTimeString")LOAD_INTERFACELIB_PROC(GetToolboxTrapAddress,"\pGetToolboxTrapAddress")LOAD_INTERFACELIB_PROC(GetEvQHdr,"\pGetEvQHdr")LOAD_INTERFACELIB_PROC(OSEventAvail,"\pOSEventAvail")LOAD_INTERFACELIB_PROC(PBControlAsync,"\pPBControlAsync")LOAD_INTERFACELIB_PROC(GetWDInfo,"\pGetWDInfo")LOAD_INTERFACELIB_PROC(SysEnvirons,"\pSysEnvirons")LOAD_INTERFACELIB_PROC(NGetTrapAddress,"\pNGetTrapAddress")LOAD_INTERFACELIB_PROC(PBControlSync,"\pPBControlSync")LOAD_INTERFACELIB_PROC(PBOpenSync,"\pPBOpenSync")LOAD_INTERFACELIB_PROC(NewRoutineDescriptor,"\pNewRoutineDescriptor")LOAD_INTERFACELIB_PROC(DisposeRoutineDescriptor,"\pDisposeRoutineDescriptor")LOAD_INTERFACELIB_PROC(CallUniversalProc,"\pCallUniversalProc")LOAD_INTERFACELIB_PROC(CloseWindow,"\pCloseWindow")LOAD_INTERFACELIB_PROC(NewPtrSys,"\pNewPtrSys")LOAD_INTERFACELIB_PROC(NewHandleSys,"\pNewHandleSys")LOAD_INTERFACELIB_PROC(c2pstr,"\pc2pstr")LOAD_INTERFACELIB_PROC(p2cstr,"\pp2cstr")LOAD_INTERFACELIB_PROC(MaxApplZone,"\pMaxApplZone")	}	return(err);}///////////OSErr pseudoCarbonInitializeFragment(struct CFragInitBlock* initBlkPtr){    OSErr err = noErr;#ifdef __MWERKS__    {    	extern OSErr __initialize( CFragInitBlock* initBlkPtr);    	err = __initialize((CFragInitBlock *) initBlkPtr);    }#endif    if (err == noErr)    	err = InitpseudoCarbon();    return err;}void pseudoCarbonTerminateFragment(){#ifdef __MWERKS__    {    	extern void __terminate(void);    	__terminate();    }#endif}